import{n as ke,e as N,s as x,d as V,m as T,b as L,f as y,o as r,q as X,i as O,p as w,J as G,C as be,c as W,L as we,k as A,l as I,S as Z,a as Ee,y as re,z as le,g as Te,B as De,G as Ce}from"../chunks/scheduler.24efe3e9.js";import{S as Me,i as Pe,c as qe,a as Ae,m as Ie,t as Se,b as Ge,d as Ne}from"../chunks/index.d51c8976.js";import{e as $,u as Ve,d as Oe}from"../chunks/each.9800de32.js";import{s as Be}from"../chunks/spring.04e8eab4.js";import{l as ee}from"../chunks/maths.c8a7eaa0.js";import{s as K}from"../chunks/dom.affe8f60.js";import{h as Fe}from"../chunks/colors.454075f6.js";import{g as Ue}from"../chunks/dimensions.c3d7a04e.js";import{g as xe}from"../chunks/audioCtx.5db2508d.js";import{v as Le,S as R}from"../chunks/helpers.ba636136.js";import{f as Xe,D as Ye}from"../chunks/constants.7774d84e.js";import{F as ze}from"../chunks/FloatingIconButton.04ba74ff.js";function te(s,t,e){const l=s.slice();return l[33]=t[e],l}function se(s){let t,e,l,f,i=[],k=new Map,d,a,h,b,E,o,m,_,u=$(s[4]);const g=c=>c[33].id;for(let c=0;c<u.length;c+=1){let p=te(s,u,c),v=g(p);k.set(v,i[c]=ie(v,p))}return{c(){t=A("svg"),e=A("image"),l=A("defs"),f=A("mask");for(let c=0;c<i.length;c+=1)i[c].c();d=A("filter"),a=A("feGaussianBlur"),h=A("circle"),o=A("circle"),this.h()},l(c){t=I(c,"svg",{class:!0});var p=T(t);e=I(p,"image",{"xlink:href":!0,width:!0,height:!0,mask:!0}),T(e).forEach(y),l=I(p,"defs",{});var v=T(l);f=I(v,"mask",{id:!0});var B=T(f);for(let C=0;C<i.length;C+=1)i[C].l(B);B.forEach(y),v.forEach(y),d=I(p,"filter",{id:!0,height:!0,width:!0,y:!0,x:!0});var F=T(d);a=I(F,"feGaussianBlur",{in:!0,stdDeviation:!0}),T(a).forEach(y),F.forEach(y),h=I(p,"circle",{class:!0,cx:!0,cy:!0,r:!0,filter:!0}),T(h).forEach(y),o=I(p,"circle",{class:!0,cx:!0,cy:!0,r:!0}),T(o).forEach(y),p.forEach(y),this.h()},h(){Z(e,"xlink:href",s[3]),r(e,"width",s[0]),r(e,"height",s[1]),r(e,"mask","url(#linePaths)"),r(f,"id","linePaths"),r(a,"in","SourceGraphic"),r(a,"stdDeviation","15"),r(d,"id","blurOuter"),r(d,"height","300%"),r(d,"width","300%"),r(d,"y","-50%"),r(d,"x","-50%"),r(h,"class","outer svelte-1yrfxd2"),r(h,"cx",b=s[6].x),r(h,"cy",E=s[6].y),r(h,"r",30),r(h,"filter","url(#blurOuter)"),r(o,"class","inner svelte-1yrfxd2"),r(o,"cx",m=s[6].x),r(o,"cy",_=s[6].y),r(o,"r",2),r(t,"class","drawing svelte-1yrfxd2")},m(c,p){O(c,t,p),w(t,e),w(t,l),w(l,f);for(let v=0;v<i.length;v+=1)i[v]&&i[v].m(f,null);w(t,d),w(d,a),w(t,h),w(t,o)},p(c,p){p[0]&8&&Z(e,"xlink:href",c[3]),p[0]&1&&r(e,"width",c[0]),p[0]&2&&r(e,"height",c[1]),p[0]&16&&(u=$(c[4]),i=Ve(i,p,g,1,c,u,k,f,Oe,ie,null,te)),p[0]&64&&b!==(b=c[6].x)&&r(h,"cx",b),p[0]&64&&E!==(E=c[6].y)&&r(h,"cy",E),p[0]&64&&m!==(m=c[6].x)&&r(o,"cx",m),p[0]&64&&_!==(_=c[6].y)&&r(o,"cy",_)},d(c){c&&y(t);for(let p=0;p<i.length;p+=1)i[p].d()}}}function ie(s,t){let e,l;return{key:s,first:null,c(){e=A("polyline"),this.h()},l(f){e=I(f,"polyline",{points:!0,stroke:!0,"stroke-width":!0,fill:!0}),T(e).forEach(y),this.h()},h(){r(e,"points",l=t[33].points),r(e,"stroke","white"),r(e,"stroke-width","5"),r(e,"fill","none"),this.first=e},m(f,i){O(f,e,i)},p(f,i){t=f,i[0]&16&&l!==(l=t[33].points)&&r(e,"points",l)},d(f){f&&y(e)}}}function ne(s){let t;return{c(){t=N("canvas"),this.h()},l(e){t=V(e,"CANVAS",{class:!0}),T(t).forEach(y),this.h()},h(){r(t,"class","bg-canvas svelte-1yrfxd2")},m(e,l){O(e,t,l),s[18](t)},p:Ee,d(e){e&&y(t),s[18](null)}}}function oe(s){let t,e,l,f,i="hz";return{c(){t=N("div"),e=N("div"),l=re(s[5]),f=N("span"),f.textContent=i,this.h()},l(k){t=V(k,"DIV",{class:!0});var d=T(t);e=V(d,"DIV",{});var a=T(e);l=le(a,s[5]),f=V(a,"SPAN",{class:!0,"data-svelte-h":!0}),Te(f)!=="svelte-1ewdw3h"&&(f.textContent=i),a.forEach(y),d.forEach(y),this.h()},h(){r(f,"class","unit svelte-1yrfxd2"),r(t,"class","freq idle_fade svelte-1yrfxd2")},m(k,d){O(k,t,d),w(t,e),w(e,l),w(e,f)},p(k,d){d[0]&32&&De(l,k[5])},d(k){k&&y(t)}}}function Ke(s){let t;return{c(){t=re("↻")},l(e){t=le(e,"↻")},m(e,l){O(e,t,l)},d(e){e&&y(t)}}}function Re(s){let t,e,l,f,i,k,d,a,h,b,E,o=s[3]&&se(s),m=s[0]!==void 0&&ne(s),_=s[5]&&oe(s);return a=new ze({props:{label:"reset",$$slots:{default:[Ke]},$$scope:{ctx:s}}}),a.$on("click",s[12]),{c(){t=N("div"),o&&o.c(),e=x(),m&&m.c(),l=x(),_&&_.c(),f=x(),i=N("div"),k=x(),d=N("div"),qe(a.$$.fragment),this.h()},l(u){t=V(u,"DIV",{class:!0,style:!0});var g=T(t);o&&o.l(g),e=L(g),m&&m.l(g),l=L(g),_&&_.l(g),f=L(g),i=V(g,"DIV",{role:!0,class:!0}),T(i).forEach(y),k=L(g),d=V(g,"DIV",{class:!0});var c=T(d);Ae(a.$$.fragment,c),c.forEach(y),g.forEach(y),this.h()},h(){r(i,"role","none"),r(i,"class","interaction-surface svelte-1yrfxd2"),r(d,"class","controls idle_fade svelte-1yrfxd2"),r(t,"class","paint-freqs svelte-1yrfxd2"),X(t,"width",s[0]+"px"),X(t,"height",s[1]+"px")},m(u,g){O(u,t,g),o&&o.m(t,null),w(t,e),m&&m.m(t,null),w(t,l),_&&_.m(t,null),w(t,f),w(t,i),w(t,k),w(t,d),Ie(a,d,null),h=!0,b||(E=[G(i,"mousedown",s[9]),G(i,"mouseup",s[10]),G(i,"mouseleave",s[10]),G(i,"mousemove",s[11]),G(i,"touchstart",s[9]),G(i,"touchend",s[10]),G(i,"touchcancel",s[10]),G(i,"touchmove",s[11])],b=!0)},p(u,g){u[3]?o?o.p(u,g):(o=se(u),o.c(),o.m(t,e)):o&&(o.d(1),o=null),u[0]!==void 0?m?m.p(u,g):(m=ne(u),m.c(),m.m(t,l)):m&&(m.d(1),m=null),u[5]?_?_.p(u,g):(_=oe(u),_.c(),_.m(t,f)):_&&(_.d(1),_=null);const c={};g[1]&32&&(c.$$scope={dirty:g,ctx:u}),a.$set(c),(!h||g[0]&1)&&X(t,"width",u[0]+"px"),(!h||g[0]&2)&&X(t,"height",u[1]+"px")},i(u){h||(Se(a.$$.fragment,u),h=!0)},o(u){Ge(a.$$.fragment,u),h=!1},d(u){u&&y(t),o&&o.d(),m&&m.d(),_&&_.d(),Ne(a),b=!1,be(E)}}}const He=.35,Je=20,je=6e3,Qe=.5,We=1.5;function Ze(s,t,e){let l,f,i,k;const d=Ue();W(s,d,n=>e(17,i=n));let a=i.width,h=i.height,b=-300,E=-300,o,m,_,u;const g=Array.from({length:12},(n,P)=>Fe(P/12,.3,.5)),c=()=>{_&&_.width===a&&_.height===h||(o.width!==a&&e(2,o.width=a,o),o.height!==h&&e(2,o.height=h,o),m||(m=o.getContext("2d")),m.clearRect(0,0,a,h),_=m.createImageData(a,h),p(_,m))},p=(n,P)=>{const{data:q}=n;for(let M=0;M<q.length;M+=4){const U=M/4,z=U%a,me=Math.floor(U/a),_e=J(z,me,a,h),pe=Xe(_e,Ye)%12,[ge,ve,ye]=g[pe];q[M]=ge,q[M+1]=ve,q[M+2]=ye,q[M+3]=255}P.putImageData(n,0,0),e(3,u=o.toDataURL())};let v=[{id:0,points:""}];const B=()=>({id:v[v.length-1].id+1,points:""}),F=(n,P)=>{const q=` ${n},${P}`,M=v[v.length-1];M.points?M.points+=q:M.points=`${n-3},${P-3}${q}`,e(4,v=v.slice())},C=xe(),Y=Be({x:b,y:E},{stiffness:.08,damping:.32});W(s,Y,n=>e(6,k=n));let D,S;const ae=()=>{D||(S=C.createGain(),S.gain.value=0,S.gain.setTargetAtTime(Le(He),C.currentTime,R),S.connect(C.destination),e(15,D=C.createOscillator()),e(15,D.type="sine",D),D.start(),D.connect(S))},H=()=>{!D||!S||(S.gain.setTargetAtTime(0,C.currentTime,R),D.stop(C.currentTime+R*2),e(15,D=void 0),S=void 0)};we(H);const J=(n,P,q,M)=>{const U=1-P/M,z=(n/2/q+.5)**10;return ee(Je,je,z)*ee(Qe,We,U)},j=n=>"touches"in n&&n.touches.length?n.touches[0].clientX:n.clientX,Q=n=>"touches"in n&&n.touches.length?n.touches[0].clientY:n.clientY,ce=n=>{if(!("touches"in n)&&n.button!==0)return;K(n),ae(),e(13,b=j(n)),e(14,E=Q(n));const P=B();v.push(P),e(4,v=v.slice())},fe=n=>{!("touches"in n)&&n.button!==0||(K(n),!(!C||!D)&&H())},ue=n=>{!C||!D||(K(n),n.altKey||e(13,b=j(n)),n.shiftKey||e(14,E=Q(n)))},he=()=>{e(4,v=[B()])};function de(n){Ce[n?"unshift":"push"](()=>{o=n,e(2,o)})}return s.$$.update=()=>{s.$$.dirty[0]&131072&&e(0,a=i.width),s.$$.dirty[0]&131072&&e(1,h=i.height),s.$$.dirty[0]&7&&o&&a&&h&&c(),s.$$.dirty[0]&24576&&b>=0&&F(b,E),s.$$.dirty[0]&24576&&Y.set({x:b,y:E}),s.$$.dirty[0]&24579&&e(16,l=a?J(b,E,a,h):void 0),s.$$.dirty[0]&98304&&D&&l!==void 0&&D.frequency.setValueAtTime(l,C.currentTime),s.$$.dirty[0]&65536&&e(5,f=l===void 0?"":Math.round(l))},[a,h,o,u,v,f,k,d,Y,ce,fe,ue,he,b,E,D,l,i,de]}class ut extends Me{constructor(t){super(),Pe(this,t,Ze,Re,ke,{},null,[-1,-1])}}export{ut as component};
